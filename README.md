# dask-taxi-fare-prediction
A scalable machine learning pipeline for predicting NYC taxi fares using Dask for big data processing and modeling. This project analyzes 12+ million taxi trips from March 2016 to build an accurate fare prediction model that explains 93.66% of fare variance while efficiently handling large-scale datasets.

# Описание проекта
Этот проект представляет собой комплексный анализ большого датасета поездок такси Нью-Йорка (NYC Yellow Taxi Trip Data) с использованием библиотеки Dask для обработки данных, превышающих объем оперативной памяти. Проект включает полный цикл анализа данных: от очистки и предварительной обработки до построения и оценки модели машинного обучения для предсказания стоимости поездок.

[**Используется официальный датасет такси Нью-Йорка с платформы Kaggle:**](https://www.kaggle.com/datasets/elemento/nyc-yellow-taxi-trip-data?spm=a2ty_o01.29997173.0.0.28b85171toFl1E&select=yellow_tripdata_2016-03.csv)

# Запуск
В Google Colab (рекомендуется):
[![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/VeronikaKolimova/dask-taxi-fare-prediction/blob/main/L_04_Dask_ML.ipynb)

# Основные цели
- Анализ более 12 миллионов поездок такси за март 2016 года
- Обнаружение и обработка выбросов в данных
- Исследование взаимосвязей между признаками (расстояние, время, скорость, час суток)
- Построение модели линейной регрессии для предсказания стоимости поездок
- Оценка качества модели и интерпретация результатов
- Визуализация ключевых закономерностей и результатов моделирования

# Технологический стек
**Основные библиотеки**
Dask — параллельные вычисления и обработка данных за пределами RAM
dask.dataframe — обработка табличных данных
dask-ml — машинное обучение с поддержкой Dask
NumPy/Pandas — числовые вычисления и работа с данными
Scikit-learn — метрики оценки качества моделей
Matplotlib/Seaborn — визуализация данных
Joblib — сохранение моделей и препроцессоров

# Архитектура решения
### Этапы реализации проекта:
## ***Загрузка данных***
Использование dask.dataframe.read_csv для ленивой загрузки данных из файла yellow_tripdata_2016-03.csv.
## ***Предварительная обработка данных***
Фильтрация выбросов (по расстоянию, стоимости, времени).
Вычисление новых признаков: trip_duration_sec, speed_mph, pickup_hour.
Удаление некорректных или отсутствующих значений.
## ***Подготовка данных для обучения***
Масштабирование признаков с использованием dask_ml.preprocessing.StandardScaler.
Разделение на обучающую и тестовую выборки.
## ***Обучение модели***
Использование dask_ml.linear_model.LinearRegression для построения модели предсказания стоимости поездки.
## ***Оценка и анализ модели***
Вычисление метрик: R², RMSE, MAE.
Статистический анализ ошибок (медианная, средняя, процент в пределах заданного порога).
Визуализация: корреляционные матрицы, графики ошибок, распределение предсказаний.
## ***Сохранение результатов***
Сохранение модели (joblib).
Сохранение результатов (JSON, CSV).

# Ключевые результаты

| Метрика           | Значение  | Интерпретация                          |
|:------------------|:---------:|----------------------------------------|
| **R²**            | **0.9366**| Модель объясняет **93.66%** дисперсии стоимости |
| **RMSE**          | **$2.64** | Средняя ошибка предсказания            |
| **MAE**           | **$0.71** | Средняя абсолютная ошибка              |
| **Медианная ошибка** | **$0.38**| Половина предсказаний точна в пределах **$0.38** |
| **Точность ≤ $1** | **88.3%** | **88.3%** поездок предсказаны с ошибкой ≤ $1 |
| **Точность ≤ $5** | **98.7%** | **98.7%** поездок предсказаны с ошибкой ≤ $5 |

# Интерпретация модели:
Стоимость = 12.68 + 8.15×дистанция + 2.58×время − 0.33×скорость − 0.01×пассажиры − 0.03×час

- Дистанция — главный фактор (+$8.15 за милю)
- Время в пути — второй по значимости фактор (+$2.58 за секунду)
- Скорость — обратная корреляция (выше скорость → ниже стоимость за милю)
